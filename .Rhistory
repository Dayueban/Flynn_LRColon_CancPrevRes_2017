#Lumen vs mucosa plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_right_bs, col='blue', lwd=3, add=T, lty=1)
plot(cv10f_roc_left_bs, col = 'red', lwd=3, add=T, lty=1)
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.5)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.5)
legend('bottom', legend=c(
sprintf('L Lumen vs L Mucosa, 10-fold CV, AUC =0.980'),
sprintf('R Lumen vs R Mucosa, 10-fold CV, AUC = 0.797')
),lty=c(1, 1, 1), lwd=3, col=c('red', 'blue'), bty='n', cex=1.2)
#RB vs RS
right_otu_feat <- colnames(aucrf_data_right_bs[2:6])
otu_taxa_right <- get_tax(1, right_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
rs_abunds <- shared_meta[shared_meta$location=='RS', right_otu_feat]/10000 + 1e-4
rb_abunds <- shared_meta[shared_meta$location=='RB', right_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(right_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in right_otu_feat){
stripchart(at=index-0.35, jitter(rs_abunds[,i], amount=1e-5), pch=21, bg="purple", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rb_abunds[,i], amount=1e-5), pch=21, bg="orange", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(rs_abunds[,i]),index-0.7,median(rs_abunds[,i]),index, lwd=3)
segments(median(rb_abunds[,i]),index+0.7,median(rb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_right$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Right mucosa", "Right lumen"), pch=c(21, 21), pt.bg=c("orange","purple"), cex=1.2)
#just LB vs LS
left_otu_feat <- colnames(aucrf_data_left_bs[2:6])
otu_taxa_left <- get_tax(1, left_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
ls_abunds <- shared_meta[shared_meta$location=='LS', left_otu_feat]/10000 + 1e-4
lb_abunds <- shared_meta[shared_meta$location=='LB', left_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(left_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in left_otu_feat){
stripchart(at=index-0.35, jitter(ls_abunds[,i], amount=1e-5), pch=21, bg="lightblue", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="yellow", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(ls_abunds[,i]),index-0.7,median(ls_abunds[,i]),index, lwd=2)
segments(median(lb_abunds[,i]),index+0.7,median(lb_abunds[,i]),index, lwd=2)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_left$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Left lumen"), pch=c(21, 21), pt.bg=c("yellow","lightblue"), cex=1.2)
dev.off()
plot_file <- '../submission/figure_4.pdf'
pdf(file=plot_file, width=12, height=11)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
#Lumen vs mucosa plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_right_bs, col='blue', lwd=3, add=T, lty=1)
plot(cv10f_roc_left_bs, col = 'red', lwd=3, add=T, lty=1)
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.5)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.5)
legend('bottom', legend=c(
sprintf('L Lumen vs L Mucosa, 10-fold CV, AUC =0.980'),
sprintf('R Lumen vs R Mucosa, 10-fold CV, AUC = 0.797')
),lty=c(1, 1, 1), lwd=3, col=c('red', 'blue'), bty='n', cex=1.2)
#RB vs RS
right_otu_feat <- colnames(aucrf_data_right_bs[2:6])
otu_taxa_right <- get_tax(1, right_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
rs_abunds <- shared_meta[shared_meta$location=='RS', right_otu_feat]/10000 + 1e-4
rb_abunds <- shared_meta[shared_meta$location=='RB', right_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(right_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in right_otu_feat){
stripchart(at=index-0.35, jitter(rs_abunds[,i], amount=1e-5), pch=21, bg="purple", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rb_abunds[,i], amount=1e-5), pch=21, bg="orange", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(rs_abunds[,i]),index-0.7,median(rs_abunds[,i]),index, lwd=3)
segments(median(rb_abunds[,i]),index+0.7,median(rb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_right$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Right mucosa", "Right lumen"), pch=c(21, 21), pt.bg=c("orange","purple"), cex=1.2)
#just LB vs LS
left_otu_feat <- colnames(aucrf_data_left_bs[2:6])
otu_taxa_left <- get_tax(1, left_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
ls_abunds <- shared_meta[shared_meta$location=='LS', left_otu_feat]/10000 + 1e-4
lb_abunds <- shared_meta[shared_meta$location=='LB', left_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(left_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in left_otu_feat){
stripchart(at=index-0.35, jitter(ls_abunds[,i], amount=1e-5), pch=21, bg="lightblue", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="yellow", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(ls_abunds[,i]),index-0.7,median(ls_abunds[,i]),index, lwd=2)
segments(median(lb_abunds[,i]),index+0.7,median(lb_abunds[,i]),index, lwd=2)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_left$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Left lumen"), pch=c(21, 21), pt.bg=c("yellow","lightblue"), cex=1.2)
dev.off()
plot_file <- '~/submission/figure_4.pdf'
######################################################## build and export figure
#export as PDF
plot_file <- '~/submission/figure_4.pdf'
pdf(file=plot_file, width=12, height=11)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
#Lumen vs mucosa plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_right_bs, col='blue', lwd=3, add=T, lty=1)
plot(cv10f_roc_left_bs, col = 'red', lwd=3, add=T, lty=1)
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.5)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.5)
legend('bottom', legend=c(
sprintf('L Lumen vs L Mucosa, 10-fold CV, AUC =0.980'),
sprintf('R Lumen vs R Mucosa, 10-fold CV, AUC = 0.797')
),lty=c(1, 1, 1), lwd=3, col=c('red', 'blue'), bty='n', cex=1.2)
#RB vs RS
right_otu_feat <- colnames(aucrf_data_right_bs[2:6])
otu_taxa_right <- get_tax(1, right_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
rs_abunds <- shared_meta[shared_meta$location=='RS', right_otu_feat]/10000 + 1e-4
rb_abunds <- shared_meta[shared_meta$location=='RB', right_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(right_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in right_otu_feat){
stripchart(at=index-0.35, jitter(rs_abunds[,i], amount=1e-5), pch=21, bg="purple", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rb_abunds[,i], amount=1e-5), pch=21, bg="orange", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(rs_abunds[,i]),index-0.7,median(rs_abunds[,i]),index, lwd=3)
segments(median(rb_abunds[,i]),index+0.7,median(rb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_right$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Right mucosa", "Right lumen"), pch=c(21, 21), pt.bg=c("orange","purple"), cex=1.2)
#just LB vs LS
left_otu_feat <- colnames(aucrf_data_left_bs[2:6])
otu_taxa_left <- get_tax(1, left_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
ls_abunds <- shared_meta[shared_meta$location=='LS', left_otu_feat]/10000 + 1e-4
lb_abunds <- shared_meta[shared_meta$location=='LB', left_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(left_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in left_otu_feat){
stripchart(at=index-0.35, jitter(ls_abunds[,i], amount=1e-5), pch=21, bg="lightblue", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="yellow", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(ls_abunds[,i]),index-0.7,median(ls_abunds[,i]),index, lwd=2)
segments(median(lb_abunds[,i]),index+0.7,median(lb_abunds[,i]),index, lwd=2)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_left$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Left lumen"), pch=c(21, 21), pt.bg=c("yellow","lightblue"), cex=1.2)
dev.off()
plot_file <- '~/../submission/figure_4.pdf'
pdf(file=plot_file, width=12, height=11)
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_4.pdf'
pdf(file=plot_file, width=12, height=11)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
#Lumen vs mucosa plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_right_bs, col='blue', lwd=3, add=T, lty=1)
plot(cv10f_roc_left_bs, col = 'red', lwd=3, add=T, lty=1)
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.5)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.5)
legend('bottom', legend=c(
sprintf('L Lumen vs L Mucosa, 10-fold CV, AUC =0.980'),
sprintf('R Lumen vs R Mucosa, 10-fold CV, AUC = 0.797')
),lty=c(1, 1, 1), lwd=3, col=c('red', 'blue'), bty='n', cex=1.2)
#RB vs RS
right_otu_feat <- colnames(aucrf_data_right_bs[2:6])
otu_taxa_right <- get_tax(1, right_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
rs_abunds <- shared_meta[shared_meta$location=='RS', right_otu_feat]/10000 + 1e-4
rb_abunds <- shared_meta[shared_meta$location=='RB', right_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(right_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in right_otu_feat){
stripchart(at=index-0.35, jitter(rs_abunds[,i], amount=1e-5), pch=21, bg="purple", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rb_abunds[,i], amount=1e-5), pch=21, bg="orange", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(rs_abunds[,i]),index-0.7,median(rs_abunds[,i]),index, lwd=3)
segments(median(rb_abunds[,i]),index+0.7,median(rb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_right$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Right mucosa", "Right lumen"), pch=c(21, 21), pt.bg=c("orange","purple"), cex=1.2)
#just LB vs LS
left_otu_feat <- colnames(aucrf_data_left_bs[2:6])
otu_taxa_left <- get_tax(1, left_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
ls_abunds <- shared_meta[shared_meta$location=='LS', left_otu_feat]/10000 + 1e-4
lb_abunds <- shared_meta[shared_meta$location=='LB', left_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(left_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in left_otu_feat){
stripchart(at=index-0.35, jitter(ls_abunds[,i], amount=1e-5), pch=21, bg="lightblue", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="yellow", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(ls_abunds[,i]),index-0.7,median(ls_abunds[,i]),index, lwd=2)
segments(median(lb_abunds[,i]),index+0.7,median(lb_abunds[,i]),index, lwd=2)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_left$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Left lumen"), pch=c(21, 21), pt.bg=c("yellow","lightblue"), cex=1.2)
dev.off()
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_4.pdf'
pdf(file=plot_file, width=10, height=12)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
#Lumen vs mucosa plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_right_bs, col='blue', lwd=3, add=T, lty=1)
plot(cv10f_roc_left_bs, col = 'red', lwd=3, add=T, lty=1)
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.5)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.5)
legend('bottom', legend=c(
sprintf('L Lumen vs L Mucosa, 10-fold CV, AUC =0.980'),
sprintf('R Lumen vs R Mucosa, 10-fold CV, AUC = 0.797')
),lty=c(1, 1, 1), lwd=3, col=c('red', 'blue'), bty='n', cex=1.2)
#RB vs RS
right_otu_feat <- colnames(aucrf_data_right_bs[2:6])
otu_taxa_right <- get_tax(1, right_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
rs_abunds <- shared_meta[shared_meta$location=='RS', right_otu_feat]/10000 + 1e-4
rb_abunds <- shared_meta[shared_meta$location=='RB', right_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(right_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in right_otu_feat){
stripchart(at=index-0.35, jitter(rs_abunds[,i], amount=1e-5), pch=21, bg="purple", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rb_abunds[,i], amount=1e-5), pch=21, bg="orange", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(rs_abunds[,i]),index-0.7,median(rs_abunds[,i]),index, lwd=3)
segments(median(rb_abunds[,i]),index+0.7,median(rb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_right$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Right mucosa", "Right lumen"), pch=c(21, 21), pt.bg=c("orange","purple"), cex=1.2)
#just LB vs LS
left_otu_feat <- colnames(aucrf_data_left_bs[2:6])
otu_taxa_left <- get_tax(1, left_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
ls_abunds <- shared_meta[shared_meta$location=='LS', left_otu_feat]/10000 + 1e-4
lb_abunds <- shared_meta[shared_meta$location=='LB', left_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(left_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in left_otu_feat){
stripchart(at=index-0.35, jitter(ls_abunds[,i], amount=1e-5), pch=21, bg="lightblue", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="yellow", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(ls_abunds[,i]),index-0.7,median(ls_abunds[,i]),index, lwd=2)
segments(median(lb_abunds[,i]),index+0.7,median(lb_abunds[,i]),index, lwd=2)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_left$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Left lumen"), pch=c(21, 21), pt.bg=c("yellow","lightblue"), cex=1.2)
dev.off()
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_4.pdf'
pdf(file=plot_file, width=9, height=12)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
#Lumen vs mucosa plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_right_bs, col='blue', lwd=3, add=T, lty=1)
plot(cv10f_roc_left_bs, col = 'red', lwd=3, add=T, lty=1)
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.2)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.2)
legend('bottom', legend=c(
sprintf('L Lumen vs L Mucosa, 10-fold CV, AUC =0.980'),
sprintf('R Lumen vs R Mucosa, 10-fold CV, AUC = 0.797')
),lty=c(1, 1, 1), lwd=3, col=c('red', 'blue'), bty='n', cex=1.2)
#RB vs RS
right_otu_feat <- colnames(aucrf_data_right_bs[2:6])
otu_taxa_right <- get_tax(1, right_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
rs_abunds <- shared_meta[shared_meta$location=='RS', right_otu_feat]/10000 + 1e-4
rb_abunds <- shared_meta[shared_meta$location=='RB', right_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(right_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in right_otu_feat){
stripchart(at=index-0.35, jitter(rs_abunds[,i], amount=1e-5), pch=21, bg="purple", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rb_abunds[,i], amount=1e-5), pch=21, bg="orange", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(rs_abunds[,i]),index-0.7,median(rs_abunds[,i]),index, lwd=3)
segments(median(rb_abunds[,i]),index+0.7,median(rb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_right$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Right mucosa", "Right lumen"), pch=c(21, 21), pt.bg=c("orange","purple"), cex=1.2)
#just LB vs LS
left_otu_feat <- colnames(aucrf_data_left_bs[2:6])
otu_taxa_left <- get_tax(1, left_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
ls_abunds <- shared_meta[shared_meta$location=='LS', left_otu_feat]/10000 + 1e-4
lb_abunds <- shared_meta[shared_meta$location=='LB', left_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(left_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in left_otu_feat){
stripchart(at=index-0.35, jitter(ls_abunds[,i], amount=1e-5), pch=21, bg="lightblue", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="yellow", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(ls_abunds[,i]),index-0.7,median(ls_abunds[,i]),index, lwd=2)
segments(median(lb_abunds[,i]),index+0.7,median(lb_abunds[,i]),index, lwd=2)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_left$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Left lumen"), pch=c(21, 21), pt.bg=c("yellow","lightblue"), cex=1.2)
dev.off()
####################################### Figure 5
#export as PDF
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_5.pdf'
pdf(file=plot_file, width=9, height=12)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
#left vs right mucosa and lumen plot
par(mar=c(4,4,1,1))
plot(c(1,0),c(0,1), type='l', lty=3, xlim=c(1.01,0), ylim=c(-0.01,1.01), xaxs='i', yaxs='i', ylab='', xlab='', cex.axis=1.5)
plot(cv10f_roc_muc,col = 'green4', lwd=3, add=T, lty=1) #r vs l mucosa cross validation
plot(cv10f_roc_lum, col = 'orange', lwd=3, add=T, lty=1) #r vs l lumen cross validation
mtext(side=2, text="True Positive (Sensitivity)", line=2.5, cex=1.2)
mtext(side=1, text="True Negative (Specificity)", line=2.5, cex=1.2)
legend('bottom', legend=c(sprintf('L mucosa vs R mucosa 10-fold CV, AUC = 0.912'),
sprintf('L lumen vs R lumen 10-fold CV, AUC = 0.7551')
# sprintf('OOB vs Leave-1-out: p=%.2g', roc.test(otu_euth_roc,LOO_roc)$p.value),
# sprintf('OOB vs 10-fold CV: p=%.2g', roc.test(otu_euth_roc,cv10f_roc)$p.value)
),lty=c(1, 1), lwd=2, col=c('green4', 'orange'), bty='n', cex=1.2)
#Lb vs Rb
LRbowel_otu_feat <- colnames(aucrf_data_LRbowel[2:6])
otu_taxa_LRbowel <- get_tax(1, LRbowel_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
lb_abunds <- shared_meta[shared_meta$location=='LB', LRbowel_otu_feat]/10000 + 1e-4
rblb_abunds <- shared_meta[shared_meta$location=='RB', LRbowel_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(LRbowel_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in LRbowel_otu_feat){
stripchart(at=index-0.35, jitter(lb_abunds[,i], amount=1e-5), pch=21, bg="darkgreen", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rblb_abunds[,i], amount=1e-5), pch=21, bg="pink", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(lb_abunds[,i]),index-0.7,median(lb_abunds[,i]),index, lwd=3)
segments(median(rblb_abunds[,i]),index+0.7,median(rblb_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_LRbowel$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left mucosa", "Right mucosa"), pch=c(21, 21), pt.bg=c("darkgreen","pink"), cex=1.2)
#LS vs RS
LRlumen_otu_feat <- colnames(aucrf_data_LRlumen[2:6])
otu_taxa_LRlumen <- get_tax(1, LRlumen_otu_feat, tax_file)
#Abundance stripchart or most predictive otus
lsrs_abunds <- shared_meta[shared_meta$location=='LS', LRlumen_otu_feat]/10000 + 1e-4
rsls_abunds <- shared_meta[shared_meta$location=='RS', LRlumen_otu_feat]/10000 + 1e-4
par(mar=c(5, 15, 1, 1))
plot(1, type="n", ylim=c(0,length(LRlumen_otu_feat)*2), xlim=c(1e-4,3), log="x", ylab="", xlab="Relative Abundance (%)", xaxt="n", yaxt="n", cex.lab=1.5)
index <- 1
for(i in LRlumen_otu_feat){
stripchart(at=index-0.35, jitter(lsrs_abunds[,i], amount=1e-5), pch=21, bg="brown", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
stripchart(at=index+0.35, jitter(rsls_abunds[,i], amount=1e-5), pch=21, bg="magenta", method="jitter", jitter=0.2, add=T, cex=1.2, lwd=0.5)
segments(median(lsrs_abunds[,i]),index-0.7,median(lsrs_abunds[,i]),index, lwd=3)
segments(median(rsls_abunds[,i]),index+0.7,median(rsls_abunds[,i]),index, lwd=3)
index <- index + 2
}
axis(2, at=seq(1,index-2,2), labels=otu_taxa_LRlumen$tax_label, las=1, line=-0.5, tick=F, cex.axis=1.2)
axis(1, at=c(1e-4, 1e-3, 1e-2, 1e-1, 1), label=c("0", "0.1", "1", "10", "100"), cex.axis=1.2)
legend('topright', legend=c("Left lumen", "Right lumen"), pch=c(21, 21), pt.bg=c("brown","magenta"), cex=1.2)
dev.off()
#export as PDF
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_5.pdf'
pdf(file=plot_file, width=9, height=12)
layout(matrix(c(1,
2,
3),
nrow=3, byrow = TRUE))
meta_file <- read.table(file='data/raw/kws_metadata.tsv', header = T)
shared_file <- read.table(file='data/mothur/kws_final.an.shared', sep = '\t', header=T, row.names=2)
tax_file <- read.table(file='data/mothur/kws_final.an.cons.taxonomy', sep = '\t', header=T, row.names=1)
subsampled_file <- read.table(file='data/mothur/kws_final.an.0.03.subsample.shared', sep = '\t', header=T, row.names=2)
shared_meta <- merge(meta_file, shared_file, by.x='group', by.y='row.names')
subsampled_meta <- merge(meta_file, subsampled_file, by.x='group', by.y='row.names')
only_fuso <- shared_meta[, colnames(shared_meta) %in% c('group', 'location', 'Otu00179', 'Otu00184', 'Otu00314', 'Otu00472', 'Otu01440')]
only_subsampled_fuso <- subsampled_meta[, colnames(subsampled_meta) %in% c('group', 'location', 'Otu00179', 'Otu00184', 'Otu00314', 'Otu00472', 'Otu01440')]
only_fuso[,8] <- only_fuso[,3] + only_fuso[,4] + only_fuso[,5] + only_fuso[,6] + only_fuso[,7]
names(only_fuso)[8] <- "total_fuso"
fuso179 <- subsampled_meta[, colnames(subsampled_meta) %in% c("group", "patient", "location", "Otu00179")]
fuso179[,5] <- (fuso179[,4]/4321)*100
names(fuso179)[5] <- "Otu00179_relAbund"
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw()
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw()
ggplot(only_subsampled_fuso, aes(x=location, y=Otu00179)) +geom_point() + geom_jitter() +theme_bw()
ggplot(only_subsampled_fuso, aes(x=location, y=Otu00179)) +geom_point() + geom_jitter() +theme_bw()
dev.off()
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw()
positions <- c("RB", "RS", "LB", "LS", "SS")
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw() =
ylab("Fusobacterium nucleatum subsp animalis relative abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 16), axis.title= element_text(size=18))
positions <- c("RB", "RS", "LB", "LS", "SS")
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("Fusobacterium nucleatum subsp animalis relative abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 16), axis.title= element_text(size=18))
positions <- c("RB", "RS", "LB", "LS", "SS")
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("Fusobacterium nucleatum subsp animalis relative abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 14), axis.title= element_text(size=14))
positions <- c("RB", "RS", "LB", "LS", "SS")
ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("F. nucleatum Relative Abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 14), axis.title= element_text(size=14))
fuso_plot <- ggplot(fuso179, aes(x=location, y=Otu00179_relAbund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("F. nucleatum Relative Abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 14), axis.title= element_text(size=14))
positions <- c("RB", "RS", "LB", "LS", "SS")
porphy_plot <- ggplot(p_152, aes(x=location, y=Otu152_relAbund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("P. asacharolytica Relative Abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 14), axis.title= element_text(size=14))
p_152 <-subsampled_meta[, colnames(shared_meta) %in% c("Group", "patient", "location", "Otu00152")]
p_152[,4] <- (p_152[,3]/4321) *100
names(p_152)[4] <- "Otu152_abund"
positions <- c("RB", "RS", "LB", "LS", "SS")
porphy_plot <- ggplot(p_152, aes(x=location, y=Otu152_relAbund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("P. asacharolytica Relative Abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 14), axis.title= element_text(size=14))
porphy_plot
positions <- c("RB", "RS", "LB", "LS", "SS")
porphy_plot <- ggplot(p_152, aes(x=location, y=Otu152_abund)) +geom_jitter(width=0.3) +theme_bw() +
ylab("P. asacharolytica Relative Abundance") +
scale_x_discrete(limits = positions, breaks=positions,
labels=c("R Mucosa", "R Lumen", "L Mucosa", "L Lumen", "Stool")) +
theme(legend.position='none', axis.title.x=element_blank(), axis.text = element_text(size= 14), axis.title= element_text(size=14))
porphy_plot
plot_file <- '~/Documents/Schloss_Lab/Flynn_LRColon_XXXX_2017/submission/figure_3.pdf'
pdf(file=plot_file, width=12, height=11)
layout(matrix(c(1,
2),
nrow=2, byrow = TRUE))
fuso_plot
porphy_plot
dev.off()
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_6.pdf'
pdf(file=plot_file, width=12, height=11)
layout(matrix(c(1,
2),
nrow=2, byrow = TRUE))
fuso_plot
porphy_plot
dev.off()
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_6.pdf'
pdf(file=plot_file, width=9, height=8)
layout(matrix(c(1,
2),
nrow=2, byrow = TRUE))
fuso_plot
porphy_plot
dev.off()
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_6.pdf'
pdf(file=plot_file, width=9, height=7)
layout(matrix(c(1,
2),
nrow=2, byrow = TRUE))
fuso_plot
porphy_plot
dev.off()
plot_file <- '~/Documents/Schloss_Lab/KWS_Project/Flynn_LRColon_XXXX_2017/submission/figure_6.pdf'
pdf(file=plot_file, width=9, height=6)
layout(matrix(c(1,
2),
nrow=2, byrow = TRUE))
fuso_plot
porphy_plot
dev.off()
